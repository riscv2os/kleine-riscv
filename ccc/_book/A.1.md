### 附錄：RISC-V 指令集參考

RISC-V 指令集架構（ISA）是當前非常流行的精簡指令集（RISC）之一。它具有開源、模組化、高效的特點，適合於各種不同類型的計算平台。這一附錄將提供一份簡明的 RISC-V 指令集參考，並詳細說明常見的指令及其功能。

#### A.1 基本指令類型

RISC-V 的基本指令可以根據它們的功能分為以下幾種類型：

1. **算術和邏輯指令**
   - 這些指令執行基本的算術操作（如加減法）以及邏輯操作（如按位與、或、異或）。
   - 常見指令包括：
     - `ADD rd, rs1, rs2`：將寄存器 rs1 和 rs2 的值相加，結果存入寄存器 rd。
     - `SUB rd, rs1, rs2`：將寄存器 rs1 和 rs2 的值相減，結果存入寄存器 rd。
     - `AND rd, rs1, rs2`：對寄存器 rs1 和 rs2 進行按位與操作，結果存入寄存器 rd。
     - `OR rd, rs1, rs2`：對寄存器 rs1 和 rs2 進行按位或操作，結果存入寄存器 rd。

2. **移位指令**
   - 這類指令執行位移操作，將數值向左或向右移動。
   - 常見指令包括：
     - `SLL rd, rs1, rs2`：將寄存器 rs1 的值左移 rs2 位，結果存入寄存器 rd。
     - `SRL rd, rs1, rs2`：將寄存器 rs1 的值右移 rs2 位，結果存入寄存器 rd。

3. **比較指令**
   - 這類指令用於比較兩個數值，並根據比較結果設置條件標誌位或改變執行流。
   - 常見指令包括：
     - `SLT rd, rs1, rs2`：如果 rs1 的值小於 rs2，rd 設置為 1，否則設置為 0。
     - `SLTU rd, rs1, rs2`：與 SLT 類似，但比較無符號數。

4. **分支與跳轉指令**
   - 用於控制程序執行流程，根據條件進行分支跳轉。
   - 常見指令包括：
     - `BEQ rs1, rs2, offset`：如果 rs1 和 rs2 相等，跳轉到相對地址 offset。
     - `BNE rs1, rs2, offset`：如果 rs1 和 rs2 不相等，跳轉到相對地址 offset。
     - `JAL rd, offset`：跳轉到相對地址 offset，並將返回地址存入 rd。
     - `JALR rd, rs1, offset`：計算目標地址 rs1 + offset，跳轉並將返回地址存入 rd。

5. **存儲與加載指令**
   - 負責將數據從內存讀取到寄存器，或者將寄存器中的數據寫回內存。
   - 常見指令包括：
     - `LW rd, offset(rs1)`：從內存中讀取一個字（32 位）到寄存器 rd。
     - `SW rs2, offset(rs1)`：將寄存器 rs2 的值存入內存地址 rs1 + offset。

#### A.2 指令格式

RISC-V 的指令長度為 32 位，並且使用了固定的指令格式。根據操作數的類型和功能，RISC-V 的指令主要有以下幾種格式：

1. **R 型格式**
   - 用於三操作數指令（如加法、減法）。
   - 格式如下：
     ```
     [ funct7 (7 bits) | rs2 (5 bits) | rs1 (5 bits) | funct3 (3 bits) | rd (5 bits) | opcode (7 bits) ]
     ```

2. **I 型格式**
   - 用於立即數操作或單個內存訪問指令。
   - 格式如下：
     ```
     [ imm[11:0] (12 bits) | rs1 (5 bits) | funct3 (3 bits) | rd (5 bits) | opcode (7 bits) ]
     ```

3. **S 型格式**
   - 用於存儲類指令，將寄存器數據存入內存。
   - 格式如下：
     ```
     [ imm[11:5] (7 bits) | rs2 (5 bits) | rs1 (5 bits) | funct3 (3 bits) | imm[4:0] (5 bits) | opcode (7 bits) ]
     ```

4. **B 型格式**
   - 用於條件分支指令。
   - 格式如下：
     ```
     [ imm[12|10:5] (7 bits) | rs2 (5 bits) | rs1 (5 bits) | funct3 (3 bits) | imm[4:1|11] (5 bits) | opcode (7 bits) ]
     ```

5. **U 型格式**
   - 用於以立即數進行操作，如負載上半立即數。
   - 格式如下：
     ```
     [ imm[31:12] (20 bits) | rd (5 bits) | opcode (7 bits) ]
     ```

6. **J 型格式**
   - 用於無條件跳轉指令。
   - 格式如下：
     ```
     [ imm[20|10:1|11|19:12] (20 bits) | rd (5 bits) | opcode (7 bits) ]
     ```

#### A.3 伺服器和擴展

RISC-V 指令集還提供了多種擴展，如浮點數擴展（F）、向量擴展（V）等，這些擴展增強了處理器在不同應用場景下的性能和靈活性。這些擴展的詳細描述可參考 RISC-V 標準文檔。

#### A.4 常見指令表

| 指令名稱 | 說明 | 格式 |
|----------|------|------|
| ADD | 將 rs1 和 rs2 相加，結果存入 rd | R 型 |
| SUB | 將 rs1 和 rs2 相減，結果存入 rd | R 型 |
| AND | 將 rs1 和 rs2 進行按位與操作，結果存入 rd | R 型 |
| OR  | 將 rs1 和 rs2 進行按位或操作，結果存入 rd | R 型 |
| LW  | 從內存讀取數據到 rd | I 型 |
| SW  | 將 rs2 的數據寫入內存 | S 型 |
| BEQ | 如果 rs1 和 rs2 相等，則跳轉 | B 型 |
| JAL | 無條件跳轉並保存返回地址 | J 型 |

此附錄僅提供了 RISC-V 指令集的簡要概覽，讀者可以根據實際需要參閱完整的 RISC-V 參考手冊，以獲取更詳細的指令信息和說明。